{% extends "base.html" %}
{% set title = "Leaderboard • " ~ show.title %}

{% block content %}
<div class="flex items-end justify-between gap-4">
  <div>
    <h1 class="text-3xl font-semibold tracking-tight">Leaderboard</h1>
    <p class="mt-2 text-slate-600">Overall and category leaders.</p>
  </div>
  <div class="flex gap-2">
    <a class="px-4 py-2 rounded-xl border border-slate-200 hover:bg-slate-50" href="/show/{{ show.slug }}/cars">Car list</a>
    <a class="px-4 py-2 rounded-xl bg-slate-900 text-white hover:opacity-90" href="/show/{{ show.slug }}/kiosk">Kiosk vote</a>
  </div>
</div>

<div class="mt-6 grid gap-4 lg:grid-cols-2">
  <section class="rounded-3xl bg-white border border-slate-200 shadow-sm p-6">
    <h2 class="text-xl font-semibold">Overall</h2>
    <div class="mt-4 grid gap-2">
      {% for row in overall %}
        <div class="flex items-center justify-between rounded-2xl border border-slate-200 p-3">
          <div>
            <div class="font-semibold">Car #{{ row.car_number }}</div>
            {% if row.car %}
              <div class="text-sm text-slate-600">{{ row.car.make_model }} • {{ row.car.owner_name }}</div>
            {% endif %}
          </div>
          <div class="text-xl font-semibold tabular-nums">{{ row.votes }}</div>
        </div>
      {% else %}
        <div class="text-sm text-slate-600">No votes yet.</div>
      {% endfor %}
    </div>
  </section>

  <section class="rounded-3xl bg-white border border-slate-200 shadow-sm p-6">
    <h2 class="text-xl font-semibold">By category</h2>
    <div class="mt-4 grid gap-4">
      {% for cat, rows in by_category.items() %}
        <div class="rounded-2xl border border-slate-200 p-4">
          <div class="font-semibold">{{ cat }}</div>
          <div class="mt-2 grid gap-2">
            {% for r in rows[:5] %}
              <div class="flex items-center justify-between text-sm">
                <div>
                  <span class="font-semibold">#{{ r.car_number }}</span>
                  {% if r.car %}<span class="text-slate-600">— {{ r.car.make_model }}</span>{% endif %}
                </div>
                <div class="font-semibold tabular-nums">{{ r.votes }}</div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% else %}
        <div class="text-sm text-slate-600">No votes yet.</div>
      {% endfor %}
    </div>
  </section>
</div>
{% endblock %}
